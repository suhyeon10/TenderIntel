name: Update Notion Daily Work Log

on:
  # ìˆ˜ë™ ì‹¤í–‰
  workflow_dispatch:
  # ë§¤ì¼ í•œêµ­ ì‹œê°„ ì˜¤ì „ 9ì‹œì— ìë™ ì‹¤í–‰ (UTC 00:00 = KST 09:00)
  schedule:
    - cron: '0 0 * * *'
  # main ë¸Œëœì¹˜ì— pushë  ë•Œë§ˆë‹¤ ì‹¤í–‰
  push:
    branches:
      - main

jobs:
  update-notion:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ì „ì²´ íˆìŠ¤í† ë¦¬ ê°€ì ¸ì˜¤ê¸° (ì»¤ë°‹ ë¡œê·¸ë¥¼ ìœ„í•´ í•„ìš”)

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install dependencies
        run: npm install

      - name: Configure Git
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"

      - name: Update Notion with today's work
        env:
          NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
          NOTION_PARENT_PAGE_ID: ${{ secrets.NOTION_PARENT_PAGE_ID }}
        run: npm run update-notion

      - name: Check if there were errors
        if: failure()
        run: |
          echo "âŒ Notion ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
          echo ""
          echo "ğŸ” ë¬¸ì œ í•´ê²° ë°©ë²•:"
          echo ""
          echo "1. GitHub Secrets í™•ì¸:"
          echo "   - Settings > Secrets and variables > Actions"
          echo "   - NOTION_TOKEN: Notion Integrationì˜ Internal Integration Token"
          echo "   - NOTION_PARENT_PAGE_ID: ì‘ì—… ì¼ì§€ê°€ ì €ì¥ë  ë¶€ëª¨ í˜ì´ì§€ì˜ ID"
          echo ""
          echo "2. Notion Integration ì„¤ì •:"
          echo "   - https://www.notion.so/my-integrations ì—ì„œ Integration í™•ì¸"
          echo "   - ë¶€ëª¨ í˜ì´ì§€ë¥¼ Integrationê³¼ ê³µìœ í•´ì•¼ í•©ë‹ˆë‹¤"
          echo "   - í˜ì´ì§€ ìš°ì¸¡ ìƒë‹¨ '...' > 'Add connections' > Integration ì„ íƒ"
          echo ""
          echo "3. í˜ì´ì§€ ID í™•ì¸:"
          echo "   - Notion í˜ì´ì§€ URLì—ì„œ í˜ì´ì§€ ID ì¶”ì¶œ"
          echo "   - ì˜ˆ: https://www.notion.so/Workspace-2a8b9e7b9e9f80da8505e8b3f80f2bd0"
          echo "   - í˜ì´ì§€ ID: 2a8b9e7b-9e9f-80da-8505-e8b3f80f2bd0 (í•˜ì´í”ˆ í¬í•¨)"
          echo ""
          echo "4. ê¶Œí•œ í™•ì¸:"
          echo "   - Integrationì´ 'Read content' ë° 'Insert content' ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸"
          exit 1

